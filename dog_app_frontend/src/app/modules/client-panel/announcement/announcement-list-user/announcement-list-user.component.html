<p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="10000" rejectButtonStyleClass="p-button-text"></p-confirmDialog>
<app-header headerTitle="Moje Ogłoszenia"></app-header>
<div class="max-w-full md:max-w-7xl h-full mt-2 flex mx-auto flex justify-center loaderBlock items-center">
  <div *ngIf="isContentLoading; else content" class="max-w-full md:max-w-7xl mx-auto flex justify-center loaderBlock items-center">
    <p-progressSpinner></p-progressSpinner>
  </div>
  <ng-template #content class="w-full">
    <div class="w-full mx-auto bg-white h-full px-8 flex flex-col items-center md:flex-row md:justify-center md:items-start">
      <div class="md:ml-20 w-full items-center md:my-12 flex flex-col">
        <div class="w-full">
          <div class="w-full flex justify-between items-center mt-4 md:mt-0">
            <h3 class="font-bold text-4xl">Moje ogłoszenia</h3>
            <div *ngIf="isSignedIn" routerLink="../../add" class="flex items-center cursor-pointer hover:text-gray-600">
              <i class="pi pi-plus-circle" style="font-size: 1.75rem"></i>
              <span  class="ml-1 font-bold text-base">Dodaj</span>
            </div>
          </div>
          <p-divider class="w-full"></p-divider>
          <div class="w-full flex mt-4 flex flex-col">

            <div *ngIf="isPageChanging; else announcementsContent" class="w-full flex justify-center loaderBlock items-center">
              <p-progressSpinner></p-progressSpinner>
            </div>
            <ng-template #announcementsContent>
              <div *ngFor="let announcement of announcements" class="w-full flex flex-col md:flex-row mb-8 md:mb-4 shade rounded-lg px-2 py-2 overflow-hidden items-center">
                <div class="w-1/2 md:w-1/6 flex justify-center announcement">
                  <div class="w-1/2 md:w-full ">
                    <img alt="dog photo"
                         src="{{announcement.photo.length > 0 ?
                          announcement.photo[0].url :
                          '../../../assets/background/placeholder.png'}}"
                         class="w-full h-full object-cover rounded-lg"/>
                  </div>
                </div>
                <div class="w-full md:w-5/6 announcement flex flex-col md:flex-row justify-center items-center">
                  <div class="w-3/4 announcement flex flex-col px-6 mt-4 md:mt-0 ">
                    <div class="h-1/5">
                      <h2 class="font-bold text-2xl text-center md:text-left">{{announcement.title}}</h2>
                    </div>
                    <div class="h-3/5 text-ellipsis overflow-hidden">
                      <h5 class="text-justify mt-2 text-base ">{{announcement.description | slice: 0:250}}&nbsp;...</h5>
                    </div>

                    <div class="h-1/5">
                      <h5 class="text-justify mt-2 text-base">Data rozpoczęcia: <span class="font-bold">{{announcement.start_date | date: 'short'}} </span>,
                        Data zakończenia: <span class="font-bold">{{announcement.end_date | date: 'short'}}</span>
                      </h5>
                    </div>
                  </div>
                  <div class="w-full md:w-1/4 mt-4 md:mt-0 flex flex-row justify-center items-center ">
                    <div class="flex flex-col text-center">
                      <span routerLink="../details/{{announcement.id}}" class="text-normal font-bold hover:text-gray-600 cursor-pointer">Pokaż</span>
                      <span class="mt-4 text-normal font-bold hover:text-gray-600 cursor-pointer">Zmień zdjęcie</span>
                    </div>
                    <div class="ml-4 md:ml-6">
                      <button
                        routerLink="../edit/{{announcement.id}}"
                        [preserveFragment]="false"
                        pButton pRipple icon="pi pi-pencil"
                        class="p-button-rounded p-button-success" pTooltip="Edytuj" tooltipPosition="bottom">
                      </button>
                    </div>
                    <div class="ml-1">
                      <button (click)="delete(announcement)"
                        pButton pRipple icon="pi pi-trash"
                        class="p-button-rounded p-button-warning" pTooltip="Usuń" tooltipPosition="bottom">
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div *ngIf="announcements.length <= 0" class="w-full font-bold text-2xl">
                Brak dostępnych ogłoszeń
              </div>
            </ng-template>

            <div *ngIf="totalPages > 0" class="w-full mt-4 h-36">
              <p-paginator [rows]="announcementsPerPage" [totalRecords]="totalPages" [showFirstLastIcon]="false" (onPageChange)="onPageChange($event)"></p-paginator>
            </div>
          </div>
        </div>

      </div>
    </div>
  </ng-template>
</div>
